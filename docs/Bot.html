<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Bot</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Bot.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Bot</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">The Bot monad</a></li><li><a href="#g:2">Global storage</a><ul><li><a href="#g:3">Bot-specific keys for global store</a></li></ul></li><li><a href="#g:4">Callback control</a></li><li><a href="#g:5">IO</a><ul><li><a href="#g:6">Messaging</a></li><li><a href="#g:7">Logging</a></li></ul></li><li><a href="#g:8">Re-exported for convenience</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>IRC bot monad, carrying around a state and IO. Most IRC-specific logic
is implemented in other modules.</p><p>The state, <code><a href="Store.html#t:GlobalStore">GlobalStore</a></code>, can hold values of arbitrary type; the keys used,
<code><a href="Store.html#t:GlobalKey">GlobalKey</a></code>, contain information about the type, so that the values can be
retrieved from the <code>Dynamic</code> instances that are actually stored.</p><p>The keys use strings for uniqueness, but are also unique by type. So
two different keys will only point to the same object if they have the same
key string <em>and</em> default values of the same type.</p><p>The keys also contain a default value, which is returned whenever the
lookup fails. This makes it seem as though the store was initialised with
the default values for all the keys.</p><p><code><a href="Store.html#t:GlobalStore">GlobalStore</a></code> is intended to provide a scripting interface for addon modules,
by providing a way for users to specify arbitrary stateful variables, and
share them across modules by exporting the keys.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">newtype</span> <a href="#t:Bot">Bot</a> a = <a href="#v:Bot">Bot</a> {<ul class="subs"><li><a href="#v:getBot">getBot</a> :: StateT <a href="Store.html#t:GlobalStore">GlobalStore</a> IO a</li></ul>}</li><li class="src short"><a href="#v:runBot">runBot</a> :: <a href="Bot.html#t:Bot">Bot</a> a -&gt; <a href="Store.html#t:GlobalStore">GlobalStore</a> -&gt; IO a</li><li class="src short"><span class="keyword">data</span> <a href="#t:PersistentKey">PersistentKey</a> a<ul class="subs"><li>= <a href="#v:PersistentKey">PersistentKey</a> a String String</li><li>| <a href="#v:CacheKey">CacheKey</a> a String String</li></ul></li><li class="src short"><a href="#v:getGlobal">getGlobal</a> :: <a href="Store.html#t:Typeable">Typeable</a> a =&gt; <a href="Store.html#t:GlobalKey">GlobalKey</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> a</li><li class="src short"><a href="#v:setGlobal">setGlobal</a> :: <a href="Store.html#t:Typeable">Typeable</a> a =&gt; <a href="Store.html#t:GlobalKey">GlobalKey</a> a -&gt; a -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:getGlobal-39-">getGlobal'</a> :: (Eq a, Read a, Show a, <a href="Store.html#t:Typeable">Typeable</a> a) =&gt; <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> a</li><li class="src short"><a href="#v:setGlobal-39-">setGlobal'</a> :: (Eq a, Read a, Show a, <a href="Store.html#t:Typeable">Typeable</a> a) =&gt; <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; a -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:serverHostname">serverHostname</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String</li><li class="src short"><a href="#v:serverPort">serverPort</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> Integer</li><li class="src short"><a href="#v:botNick">botNick</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String</li><li class="src short"><a href="#v:botChan">botChan</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String</li><li class="src short"><a href="#v:logDest">logDest</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String</li><li class="src short"><a href="#v:socketH">socketH</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> Handle</li><li class="src short"><a href="#v:callbackList">callbackList</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> [(<a href="Bot.html#t:CallbackHandle">CallbackHandle</a>, <a href="Msg.html#t:SEvent">SEvent</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ())]</li><li class="src short"><a href="#v:configFile">configFile</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> String</li><li class="src short"><a href="#v:timerList">timerList</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> [(<a href="Bot.html#t:CallbackHandle">CallbackHandle</a>, UTCTime, <a href="Bot.html#t:Bot">Bot</a> ())]</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:CallbackHandle">CallbackHandle</a> = <a href="#v:CallbackHandle">CallbackHandle</a> UUID</li><li class="src short"><a href="#v:addCallback">addCallback</a> :: (<a href="Msg.html#t:SEvent">SEvent</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ()) -&gt; <a href="Bot.html#t:Bot">Bot</a> <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></li><li class="src short"><a href="#v:removeCallback">removeCallback</a> :: <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:addTimer">addTimer</a> :: UTCTime -&gt; <a href="Bot.html#t:Bot">Bot</a> () -&gt; <a href="Bot.html#t:Bot">Bot</a> <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></li><li class="src short"><a href="#v:removeTimer">removeTimer</a> :: <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:runInS">runInS</a> :: Integral a =&gt; a -&gt; <a href="Bot.html#t:Bot">Bot</a> () -&gt; <a href="Bot.html#t:Bot">Bot</a> <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></li><li class="src short"><a href="#v:writeMsg">writeMsg</a> :: <a href="Msg.html#t:CMsg">CMsg</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:sendMessage">sendMessage</a> :: <a href="Msg.html#t:Recipient">Recipient</a> -&gt; String -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:joinChannels">joinChannels</a> :: [String] -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:putLog">putLog</a> :: String -&gt; String -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:putLogInfo">putLogInfo</a> :: String -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:putLogWarning">putLogWarning</a> :: String -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:putLogError">putLogError</a> :: String -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</li><li class="src short"><a href="#v:liftIO">liftIO</a> :: MonadIO m =&gt; <span class="keyword">forall</span> a. IO a -&gt; m a</li><li class="src short">module <a href="Msg.html">Msg</a></li><li class="src short">module <a href="Store.html">Store</a></li></ul></div><div id="interface"><h1 id="g:1">The Bot monad</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Bot" class="def">Bot</a> a <a href="#t:Bot" class="selflink">#</a></p><div class="doc"><p>Bot monad, having State GlobalStore and IO.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Bot" class="def">Bot</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getBot" class="def">getBot</a> :: StateT <a href="Store.html#t:GlobalStore">GlobalStore</a> IO a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Bot" class="caption collapser" onclick="toggleSection('i:Bot')">Instances</p><div id="section.i:Bot" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Bot:Monad:1" class="instance expander" onclick="toggleSection('i:id:Bot:Monad:1')"></span> Monad <a href="Bot.html#t:Bot">Bot</a></span> <a href="#t:Bot" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Bot:Monad:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="Bot.html#t:Bot">Bot</a> a -&gt; (a -&gt; <a href="Bot.html#t:Bot">Bot</a> b) -&gt; <a href="Bot.html#t:Bot">Bot</a> b</p><p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="Bot.html#t:Bot">Bot</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> b -&gt; <a href="Bot.html#t:Bot">Bot</a> b</p><p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="Bot.html#t:Bot">Bot</a> a</p><p class="src"><a href="#v:fail">fail</a> :: String -&gt; <a href="Bot.html#t:Bot">Bot</a> a</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Bot:Functor:2" class="instance expander" onclick="toggleSection('i:id:Bot:Functor:2')"></span> Functor <a href="Bot.html#t:Bot">Bot</a></span> <a href="#t:Bot" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Bot:Functor:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Bot.html#t:Bot">Bot</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> b</p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Bot.html#t:Bot">Bot</a> b -&gt; <a href="Bot.html#t:Bot">Bot</a> a</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Bot:Applicative:3" class="instance expander" onclick="toggleSection('i:id:Bot:Applicative:3')"></span> Applicative <a href="Bot.html#t:Bot">Bot</a></span> <a href="#t:Bot" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Bot:Applicative:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="Bot.html#t:Bot">Bot</a> a</p><p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="Bot.html#t:Bot">Bot</a> (a -&gt; b) -&gt; <a href="Bot.html#t:Bot">Bot</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> b</p><p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="Bot.html#t:Bot">Bot</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> b -&gt; <a href="Bot.html#t:Bot">Bot</a> b</p><p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="Bot.html#t:Bot">Bot</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> b -&gt; <a href="Bot.html#t:Bot">Bot</a> a</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Bot:MonadIO:4" class="instance expander" onclick="toggleSection('i:id:Bot:MonadIO:4')"></span> MonadIO <a href="Bot.html#t:Bot">Bot</a></span> <a href="#t:Bot" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Bot:MonadIO:4" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftIO">liftIO</a> :: IO a -&gt; <a href="Bot.html#t:Bot">Bot</a> a <a href="#v:liftIO" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Bot:MonadState:5" class="instance expander" onclick="toggleSection('i:id:Bot:MonadState:5')"></span> MonadState <a href="Store.html#t:GlobalStore">GlobalStore</a> <a href="Bot.html#t:Bot">Bot</a></span> <a href="#t:Bot" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Bot:MonadState:5" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:get">get</a> :: <a href="Bot.html#t:Bot">Bot</a> <a href="Store.html#t:GlobalStore">GlobalStore</a></p><p class="src"><a href="#v:put">put</a> :: <a href="Store.html#t:GlobalStore">GlobalStore</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ()</p><p class="src"><a href="#v:state">state</a> :: (<a href="Store.html#t:GlobalStore">GlobalStore</a> -&gt; (a, <a href="Store.html#t:GlobalStore">GlobalStore</a>)) -&gt; <a href="Bot.html#t:Bot">Bot</a> a</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:runBot" class="def">runBot</a> :: <a href="Bot.html#t:Bot">Bot</a> a -&gt; <a href="Store.html#t:GlobalStore">GlobalStore</a> -&gt; IO a <a href="#v:runBot" class="selflink">#</a></p><div class="doc"><p>Extract the IO computation by running the bot on the given initial state.</p></div></div><h1 id="g:2">Global storage</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PersistentKey" class="def">PersistentKey</a> a <a href="#t:PersistentKey" class="selflink">#</a></p><div class="doc"><p><code>PersistentKey a sec name</code> creates a key that transparently reads/writes
 a value to the config file, as a value called <code>name</code> in section <code>sec</code>.</p><p><code>CacheKey a sec name</code> does the same, but also acts as an instance of
 <code>GlobalKey a (sec ++ &quot;.&quot; ++ name)</code>; only reading the value from file once,
 storing the value in the store in memory and reading from that subequently.
 It does write to the file for every new value, though.</p><p>The objects referred to must have <code>Eq</code>, <code>Read</code> and <code>Show</code> instances for this.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:PersistentKey" class="def">PersistentKey</a> a String String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:CacheKey" class="def">CacheKey</a> a String String</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:PersistentKey" class="caption collapser" onclick="toggleSection('i:PersistentKey')">Instances</p><div id="section.i:PersistentKey" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:PersistentKey:Eq:1" class="instance expander" onclick="toggleSection('i:id:PersistentKey:Eq:1')"></span> Eq a =&gt; Eq (<a href="Bot.html#t:PersistentKey">PersistentKey</a> a)</span> <a href="#t:PersistentKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:PersistentKey:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; Bool</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:PersistentKey:Read:2" class="instance expander" onclick="toggleSection('i:id:PersistentKey:Read:2')"></span> Read a =&gt; Read (<a href="Bot.html#t:PersistentKey">PersistentKey</a> a)</span> <a href="#t:PersistentKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:PersistentKey:Read:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS (<a href="Bot.html#t:PersistentKey">PersistentKey</a> a)</p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="Bot.html#t:PersistentKey">PersistentKey</a> a]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec (<a href="Bot.html#t:PersistentKey">PersistentKey</a> a)</p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="Bot.html#t:PersistentKey">PersistentKey</a> a]</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:PersistentKey:Show:3" class="instance expander" onclick="toggleSection('i:id:PersistentKey:Show:3')"></span> Show a =&gt; Show (<a href="Bot.html#t:PersistentKey">PersistentKey</a> a)</span> <a href="#t:PersistentKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:PersistentKey:Show:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Bot.html#t:PersistentKey">PersistentKey</a> a] -&gt; ShowS</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:getGlobal" class="def">getGlobal</a> :: <a href="Store.html#t:Typeable">Typeable</a> a =&gt; <a href="Store.html#t:GlobalKey">GlobalKey</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> a <a href="#v:getGlobal" class="selflink">#</a></p><div class="doc"><p>Get the value at k in the state.</p></div></div><div class="top"><p class="src"><a id="v:setGlobal" class="def">setGlobal</a> :: <a href="Store.html#t:Typeable">Typeable</a> a =&gt; <a href="Store.html#t:GlobalKey">GlobalKey</a> a -&gt; a -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:setGlobal" class="selflink">#</a></p><div class="doc"><p>Set the value at k to v in the state.</p></div></div><div class="top"><p class="src"><a id="v:getGlobal-39-" class="def">getGlobal'</a> :: (Eq a, Read a, Show a, <a href="Store.html#t:Typeable">Typeable</a> a) =&gt; <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; <a href="Bot.html#t:Bot">Bot</a> a <a href="#v:getGlobal-39-" class="selflink">#</a></p><div class="doc"><p><code><a href="Bot.html#v:getGlobal">getGlobal</a></code>, but for <code><a href="Bot.html#t:PersistentKey">PersistentKey</a></code>. This is a separate function because
 the typeclass restrictions are stronger than <code><a href="Bot.html#v:getGlobal">getGlobal</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:setGlobal-39-" class="def">setGlobal'</a> :: (Eq a, Read a, Show a, <a href="Store.html#t:Typeable">Typeable</a> a) =&gt; <a href="Bot.html#t:PersistentKey">PersistentKey</a> a -&gt; a -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:setGlobal-39-" class="selflink">#</a></p><div class="doc"><p><code><a href="Bot.html#v:setGlobal">setGlobal</a></code>, but for <code><a href="Bot.html#t:PersistentKey">PersistentKey</a></code>. This is a separate function because
 the typeclass restrictions are stronger than <code><a href="Bot.html#v:setGlobal">setGlobal</a></code>.</p></div></div><h2 id="g:3">Bot-specific keys for global store</h2><div class="doc"><p><strong>To be initialised in config:</strong>
    The key strings here map to the relevant keys in .ini, as &quot;SECTION.key&quot;: </p></div><div class="top"><p class="src"><a id="v:serverHostname" class="def">serverHostname</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String <a href="#v:serverHostname" class="selflink">#</a></p><div class="doc"><p>IRC server host</p></div></div><div class="top"><p class="src"><a id="v:serverPort" class="def">serverPort</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> Integer <a href="#v:serverPort" class="selflink">#</a></p><div class="doc"><p>IRC server port.</p></div></div><div class="top"><p class="src"><a id="v:botNick" class="def">botNick</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String <a href="#v:botNick" class="selflink">#</a></p><div class="doc"><p>Nick of bot.</p></div></div><div class="top"><p class="src"><a id="v:botChan" class="def">botChan</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String <a href="#v:botChan" class="selflink">#</a></p><div class="doc"><p>Channel that bot should join.</p></div></div><div class="top"><p class="src"><a id="v:logDest" class="def">logDest</a> :: <a href="Bot.html#t:PersistentKey">PersistentKey</a> String <a href="#v:logDest" class="selflink">#</a></p><div class="doc"><p>Logging output filename.</p></div></div><div class="doc"><p><strong>To be initialised elsewhere before running (<code><a href="Run.html#v:startBot">startBot</a></code>):</strong> </p></div><div class="top"><p class="src"><a id="v:socketH" class="def">socketH</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> Handle <a href="#v:socketH" class="selflink">#</a></p><div class="doc"><p>Socket handle</p></div></div><div class="top"><p class="src"><a id="v:callbackList" class="def">callbackList</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> [(<a href="Bot.html#t:CallbackHandle">CallbackHandle</a>, <a href="Msg.html#t:SEvent">SEvent</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ())] <a href="#v:callbackList" class="selflink">#</a></p><div class="doc"><p>List of callbacks to apply to messages</p></div></div><div class="top"><p class="src"><a id="v:configFile" class="def">configFile</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> String <a href="#v:configFile" class="selflink">#</a></p><div class="doc"><p>Config file filename.</p></div></div><div class="doc"><p><strong>Already initialised</strong> </p></div><div class="top"><p class="src"><a id="v:timerList" class="def">timerList</a> :: <a href="Store.html#t:GlobalKey">GlobalKey</a> [(<a href="Bot.html#t:CallbackHandle">CallbackHandle</a>, UTCTime, <a href="Bot.html#t:Bot">Bot</a> ())] <a href="#v:timerList" class="selflink">#</a></p><div class="doc"><p>List of timed callbacks, to be called at the time specified.</p></div></div><h1 id="g:4">Callback control</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:CallbackHandle" class="def">CallbackHandle</a> <a href="#t:CallbackHandle" class="selflink">#</a></p><div class="doc"><p>A callback handle referring to callbacks; internally a randomly-generated
 UUID.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CallbackHandle" class="def">CallbackHandle</a> UUID</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:CallbackHandle" class="caption collapser" onclick="toggleSection('i:CallbackHandle')">Instances</p><div id="section.i:CallbackHandle" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:CallbackHandle:Eq:1" class="instance expander" onclick="toggleSection('i:id:CallbackHandle:Eq:1')"></span> Eq <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></span> <a href="#t:CallbackHandle" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:CallbackHandle:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; Bool</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:CallbackHandle:Read:2" class="instance expander" onclick="toggleSection('i:id:CallbackHandle:Read:2')"></span> Read <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></span> <a href="#t:CallbackHandle" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:CallbackHandle:Read:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="Bot.html#t:CallbackHandle">CallbackHandle</a>]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="Bot.html#t:CallbackHandle">CallbackHandle</a>]</p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:CallbackHandle:Show:3" class="instance expander" onclick="toggleSection('i:id:CallbackHandle:Show:3')"></span> Show <a href="Bot.html#t:CallbackHandle">CallbackHandle</a></span> <a href="#t:CallbackHandle" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:CallbackHandle:Show:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Bot.html#t:CallbackHandle">CallbackHandle</a>] -&gt; ShowS</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:addCallback" class="def">addCallback</a> :: (<a href="Msg.html#t:SEvent">SEvent</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> ()) -&gt; <a href="Bot.html#t:Bot">Bot</a> <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> <a href="#v:addCallback" class="selflink">#</a></p><div class="doc"><p>Add the given function as a callback for events; return the handle.</p></div></div><div class="top"><p class="src"><a id="v:removeCallback" class="def">removeCallback</a> :: <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:removeCallback" class="selflink">#</a></p><div class="doc"><p>Remove the callback referred to by the handle. Silently fails if there
 is no such callback.</p></div></div><div class="top"><p class="src"><a id="v:addTimer" class="def">addTimer</a> :: UTCTime -&gt; <a href="Bot.html#t:Bot">Bot</a> () -&gt; <a href="Bot.html#t:Bot">Bot</a> <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> <a href="#v:addTimer" class="selflink">#</a></p><div class="doc"><p>Add a timer to run the given computation at the given time, returning
 a handle.</p></div></div><div class="top"><p class="src"><a id="v:removeTimer" class="def">removeTimer</a> :: <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:removeTimer" class="selflink">#</a></p><div class="doc"><p>Remove the timer referred to by the handle. Silently fails if there
 is no such timer.</p></div></div><div class="top"><p class="src"><a id="v:runInS" class="def">runInS</a> :: Integral a =&gt; a -&gt; <a href="Bot.html#t:Bot">Bot</a> () -&gt; <a href="Bot.html#t:Bot">Bot</a> <a href="Bot.html#t:CallbackHandle">CallbackHandle</a> <a href="#v:runInS" class="selflink">#</a></p><div class="doc"><p>Run the given computation in the given number of seconds, returning
 a handle.</p></div></div><h1 id="g:5">IO</h1><h2 id="g:6">Messaging</h2><div class="top"><p class="src"><a id="v:writeMsg" class="def">writeMsg</a> :: <a href="Msg.html#t:CMsg">CMsg</a> -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:writeMsg" class="selflink">#</a></p><div class="doc"><p>Write a message out to the server.</p></div></div><div class="top"><p class="src"><a id="v:sendMessage" class="def">sendMessage</a> :: <a href="Msg.html#t:Recipient">Recipient</a> -&gt; String -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:sendMessage" class="selflink">#</a></p><div class="doc"><p>Send a textual message to the recipient</p></div></div><div class="top"><p class="src"><a id="v:joinChannels" class="def">joinChannels</a> :: [String] -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:joinChannels" class="selflink">#</a></p><div class="doc"><p>Join the list of channels, where each element is a channel name string (e.g.,
 <code>&quot;#channame&quot;</code>)</p></div></div><h2 id="g:7">Logging</h2><div class="top"><p class="src"><a id="v:putLog" class="def">putLog</a> <a href="#v:putLog" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: String</td><td class="doc"><p>Log level (e.g., <code><a href="INFO.html">INFO</a></code>, <code><a href="ERROR.html">ERROR</a></code>, etc.)</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>Line</p></td></tr><tr><td class="src">-&gt; <a href="Bot.html#t:Bot">Bot</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Write a line out to the log, prepended with a timestamp.</p></div></div><div class="top"><p class="src"><a id="v:putLogInfo" class="def">putLogInfo</a> :: String -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:putLogInfo" class="selflink">#</a></p><div class="doc"><p>Log with level INFO.</p></div></div><div class="top"><p class="src"><a id="v:putLogWarning" class="def">putLogWarning</a> :: String -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:putLogWarning" class="selflink">#</a></p><div class="doc"><p>Log with level WARNING.</p></div></div><div class="top"><p class="src"><a id="v:putLogError" class="def">putLogError</a> :: String -&gt; <a href="Bot.html#t:Bot">Bot</a> () <a href="#v:putLogError" class="selflink">#</a></p><div class="doc"><p>Log with level ERROR.</p></div></div><h1 id="g:8">Re-exported for convenience</h1><div class="top"><p class="src"><a id="v:liftIO" class="def">liftIO</a> :: MonadIO m =&gt; <span class="keyword">forall</span> a. IO a -&gt; m a <a href="#v:liftIO" class="selflink">#</a></p></div><div class="top"><p class="src">module <a href="Msg.html">Msg</a></p></div><div class="top"><p class="src">module <a href="Store.html">Store</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.2</p></div></body></html>