<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Msg</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Msg.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Msg</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Message structure</a><ul><li><a href="#g:2">Client message</a></li><li><a href="#g:3">Server message</a></li></ul></li><li><a href="#g:4">Parsing and serialising</a></li><li><a href="#g:5">Parsing internals</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Defines the internal message structure, and implements parsing/serialising.</p><p>Client messages are messages that will be sent to the server by the bot, usually
within a callback. Server messages are what the bot receives from the server,
having parsed them from the textual line sent.</p><p>Parsing is done using <code>Parsec</code>, and messages are parsed in a detailed way according
to their command.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:CMsg">CMsg</a> = <a href="#v:CMsg">CMsg</a> {<ul class="subs"><li><a href="#v:command">command</a> :: <a href="Msg.html#t:ClientCmd">ClientCmd</a></li><li><a href="#v:argsC">argsC</a> :: [String]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:ClientCmd">ClientCmd</a><ul class="subs"><li>= <a href="#v:NICK">NICK</a></li><li>| <a href="#v:USER">USER</a></li><li>| <a href="#v:JOIN">JOIN</a></li><li>| <a href="#v:PONG">PONG</a></li><li>| <a href="#v:PRIVMSG">PRIVMSG</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:SMsg">SMsg</a><ul class="subs"><li>= <a href="#v:SPing">SPing</a> { <ul class="subs"><li><a href="#v:srv">srv</a> :: String</li></ul> }</li><li>| <a href="#v:SNotice">SNotice</a> { <ul class="subs"><li><a href="#v:from">from</a> :: <a href="Msg.html#t:Sender">Sender</a></li><li><a href="#v:to">to</a> :: <a href="Msg.html#t:Recipient">Recipient</a></li><li><a href="#v:text">text</a> :: String</li></ul> }</li><li>| <a href="#v:SPrivmsg">SPrivmsg</a> { <ul class="subs"><li><a href="#v:from">from</a> :: <a href="Msg.html#t:Sender">Sender</a></li><li><a href="#v:to">to</a> :: <a href="Msg.html#t:Recipient">Recipient</a></li><li><a href="#v:text">text</a> :: String</li></ul> }</li><li>| <a href="#v:SNumeric">SNumeric</a> { <ul class="subs"><li><a href="#v:fromMaybe">fromMaybe</a> :: Maybe <a href="Msg.html#t:Sender">Sender</a></li><li><a href="#v:n">n</a> :: Int</li><li><a href="#v:args">args</a> :: [String]</li></ul> }</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Sender">Sender</a><ul class="subs"><li>= <a href="#v:SUser">SUser</a> { <ul class="subs"><li><a href="#v:nick">nick</a> :: String</li><li><a href="#v:user">user</a> :: String</li><li><a href="#v:host">host</a> :: String</li></ul> }</li><li>| <a href="#v:SServer">SServer</a> { <ul class="subs"><li><a href="#v:host">host</a> :: String</li></ul> }</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Recipient">Recipient</a><ul class="subs"><li>= <a href="#v:RUser">RUser</a> String</li><li>| <a href="#v:RChannel">RChannel</a> String</li></ul></li><li class="src short"><a href="#v:joinMsg">joinMsg</a> :: <a href="Msg.html#t:CMsg">CMsg</a> -&gt; String</li><li class="src short"><a href="#v:readMsg">readMsg</a> :: String -&gt; Either ParseError <a href="Msg.html#t:SMsg">SMsg</a></li><li class="src short"><a href="#v:parseMsg">parseMsg</a> :: Parser <a href="Msg.html#t:SMsg">SMsg</a></li><li class="src short"><a href="#v:parseSender">parseSender</a> :: Parser <a href="Msg.html#t:Sender">Sender</a></li><li class="src short"><a href="#v:parseRecipient">parseRecipient</a> :: Parser <a href="Msg.html#t:Recipient">Recipient</a></li><li class="src short"><a href="#v:parseArgs">parseArgs</a> :: Parser [String]</li><li class="src short"><a href="#v:parseUntil">parseUntil</a> :: String -&gt; Parser String</li><li class="src short"><a href="#v:parseWord">parseWord</a> :: Parser String</li></ul></div><div id="interface"><h1 id="g:1">Message structure</h1><h2 id="g:2">Client message</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CMsg" class="def">CMsg</a> <a href="#t:CMsg" class="selflink">#</a></p><div class="doc"><p>Message that will be sent by the bot. The structure is fairly barebones
 because it's not going to be parsed; whatever is sending the message can
 implement the structure correctly itself.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CMsg" class="def">CMsg</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:command" class="def">command</a> :: <a href="Msg.html#t:ClientCmd">ClientCmd</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:argsC" class="def">argsC</a> :: [String]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:CMsg" class="caption collapser" onclick="toggleSection('i:CMsg')">Instances</p><div id="section.i:CMsg" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:CMsg:Show:1" class="instance expander" onclick="toggleSection('i:id:CMsg:Show:1')"></span> Show <a href="Msg.html#t:CMsg">CMsg</a></span> <a href="#t:CMsg" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:CMsg:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Msg.html#t:CMsg">CMsg</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Msg.html#t:CMsg">CMsg</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Msg.html#t:CMsg">CMsg</a>] -&gt; ShowS</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ClientCmd" class="def">ClientCmd</a> <a href="#t:ClientCmd" class="selflink">#</a></p><div class="doc"><p>Commands that will be sent by the bot; deliberately named
 identically to their textual representations, to make serialising easy.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NICK" class="def">NICK</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:USER" class="def">USER</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:JOIN" class="def">JOIN</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:PONG" class="def">PONG</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:PRIVMSG" class="def">PRIVMSG</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:ClientCmd" class="caption collapser" onclick="toggleSection('i:ClientCmd')">Instances</p><div id="section.i:ClientCmd" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:ClientCmd:Show:1" class="instance expander" onclick="toggleSection('i:id:ClientCmd:Show:1')"></span> Show <a href="Msg.html#t:ClientCmd">ClientCmd</a></span> <a href="#t:ClientCmd" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:ClientCmd:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Msg.html#t:ClientCmd">ClientCmd</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Msg.html#t:ClientCmd">ClientCmd</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Msg.html#t:ClientCmd">ClientCmd</a>] -&gt; ShowS</p></div></div></td></tr></table></div></div></div><h2 id="g:3">Server message</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SMsg" class="def">SMsg</a> <a href="#t:SMsg" class="selflink">#</a></p><div class="doc"><p>Message that will be sent by the server and received by the client.
 These are more detailed structures; messages are parsed into easily usable
 forms for callbacks. The exception is <code><a href="Msg.html#v:SNumeric">SNumeric</a></code>, which is generic for all
 numeric messages and may have any number of arguments.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SPing" class="def">SPing</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:srv" class="def">srv</a> :: String</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:SNotice" class="def">SNotice</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:from" class="def">from</a> :: <a href="Msg.html#t:Sender">Sender</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:to" class="def">to</a> :: <a href="Msg.html#t:Recipient">Recipient</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:text" class="def">text</a> :: String</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:SPrivmsg" class="def">SPrivmsg</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:from" class="def">from</a> :: <a href="Msg.html#t:Sender">Sender</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:to" class="def">to</a> :: <a href="Msg.html#t:Recipient">Recipient</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:text" class="def">text</a> :: String</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:SNumeric" class="def">SNumeric</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:fromMaybe" class="def">fromMaybe</a> :: Maybe <a href="Msg.html#t:Sender">Sender</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:n" class="def">n</a> :: Int</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:args" class="def">args</a> :: [String]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:SMsg" class="caption collapser" onclick="toggleSection('i:SMsg')">Instances</p><div id="section.i:SMsg" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:SMsg:Show:1" class="instance expander" onclick="toggleSection('i:id:SMsg:Show:1')"></span> Show <a href="Msg.html#t:SMsg">SMsg</a></span> <a href="#t:SMsg" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:SMsg:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Msg.html#t:SMsg">SMsg</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Msg.html#t:SMsg">SMsg</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Msg.html#t:SMsg">SMsg</a>] -&gt; ShowS</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Sender" class="def">Sender</a> <a href="#t:Sender" class="selflink">#</a></p><div class="doc"><p>Sender field - can be either user or server.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SUser" class="def">SUser</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:nick" class="def">nick</a> :: String</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:user" class="def">user</a> :: String</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:host" class="def">host</a> :: String</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:SServer" class="def">SServer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:host" class="def">host</a> :: String</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Sender" class="caption collapser" onclick="toggleSection('i:Sender')">Instances</p><div id="section.i:Sender" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Sender:Show:1" class="instance expander" onclick="toggleSection('i:id:Sender:Show:1')"></span> Show <a href="Msg.html#t:Sender">Sender</a></span> <a href="#t:Sender" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Sender:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Msg.html#t:Sender">Sender</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Msg.html#t:Sender">Sender</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Msg.html#t:Sender">Sender</a>] -&gt; ShowS</p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Recipient" class="def">Recipient</a> <a href="#t:Recipient" class="selflink">#</a></p><div class="doc"><p>Recipient field - can either be user or channel.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:RUser" class="def">RUser</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:RChannel" class="def">RChannel</a> String</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Recipient" class="caption collapser" onclick="toggleSection('i:Recipient')">Instances</p><div id="section.i:Recipient" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Recipient:Show:1" class="instance expander" onclick="toggleSection('i:id:Recipient:Show:1')"></span> Show <a href="Msg.html#t:Recipient">Recipient</a></span> <a href="#t:Recipient" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Recipient:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Msg.html#t:Recipient">Recipient</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Msg.html#t:Recipient">Recipient</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Msg.html#t:Recipient">Recipient</a>] -&gt; ShowS</p></div></div></td></tr></table></div></div></div><h1 id="g:4">Parsing and serialising</h1><div class="top"><p class="src"><a id="v:joinMsg" class="def">joinMsg</a> :: <a href="Msg.html#t:CMsg">CMsg</a> -&gt; String <a href="#v:joinMsg" class="selflink">#</a></p><div class="doc"><p>Convert a message to a string in the IRC format.</p></div></div><div class="top"><p class="src"><a id="v:readMsg" class="def">readMsg</a> :: String -&gt; Either ParseError <a href="Msg.html#t:SMsg">SMsg</a> <a href="#v:readMsg" class="selflink">#</a></p><div class="doc"><p>Parse a message string in the IRC format.</p></div></div><h1 id="g:5">Parsing internals</h1><div class="top"><p class="src"><a id="v:parseMsg" class="def">parseMsg</a> :: Parser <a href="Msg.html#t:SMsg">SMsg</a> <a href="#v:parseMsg" class="selflink">#</a></p><div class="doc"><p>The main parser for messages.</p></div></div><div class="top"><p class="src"><a id="v:parseSender" class="def">parseSender</a> :: Parser <a href="Msg.html#t:Sender">Sender</a> <a href="#v:parseSender" class="selflink">#</a></p><div class="doc"><p>Parse the sender field of a message, which will be a <code>:</code>, followed by
 either a user in the form <code>nick!user@host</code>, or a server in the form <code>host</code>.</p></div></div><div class="top"><p class="src"><a id="v:parseRecipient" class="def">parseRecipient</a> :: Parser <a href="Msg.html#t:Recipient">Recipient</a> <a href="#v:parseRecipient" class="selflink">#</a></p><div class="doc"><p>Parse a recipient field, which might either be a channel in the form
 <code>#channel-name</code>, or a user in the form <code>nick</code>.</p></div></div><div class="top"><p class="src"><a id="v:parseArgs" class="def">parseArgs</a> :: Parser [String] <a href="#v:parseArgs" class="selflink">#</a></p><div class="doc"><p>Parse the arguments at the end of the message.</p></div></div><div class="top"><p class="src"><a id="v:parseUntil" class="def">parseUntil</a> :: String -&gt; Parser String <a href="#v:parseUntil" class="selflink">#</a></p><div class="doc"><p>Parse until one of the characters in <code>s</code>, or <code>eof</code>.</p></div></div><div class="top"><p class="src"><a id="v:parseWord" class="def">parseWord</a> :: Parser String <a href="#v:parseWord" class="selflink">#</a></p><div class="doc"><p>Parse until one of <code>space</code> <code>:</code> <code>r</code> <code>n</code> <code>eof</code>, and eat a trailing space
 if it's there.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.2</p></div></body></html>